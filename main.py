import picounicorn
import time
import random
picounicorn.init()

w = picounicorn.get_width()
h = picounicorn.get_height()

flakes = []
pixels = [
    [(0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (0, 0, 0), (92, 165, 45),
     (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (0, 0, 0), (92, 165, 45),
     (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (92, 165, 45), (92, 165, 45),
     (92, 165, 45), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (92, 165, 45), (92, 165, 45),
     (92, 165, 45), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (92, 165, 45), (92, 165, 45),
     (92, 165, 45), (0, 0, 0), (0, 0, 0)],
    [(0, 0, 0), (92, 165, 45), (92, 165, 45), (92, 165, 45),
     (92, 165, 45), (92, 165, 45), (0, 0, 0)],
    [(0, 0, 0), (92, 165, 45), (92, 165, 45), (92, 165, 45),
     (92, 165, 45), (92, 165, 45), (0, 0, 0)],
    [(0, 0, 0), (0, 0, 0), (0, 0, 0), (150, 75, 10),
     (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [(255, 255, 255), (255, 255, 255), (0, 0, 0), (150, 75, 10),
     (0, 0, 0), (255, 255, 255), (255, 255, 255)],
    [(255, 255, 255), (255, 255, 255), (255, 255, 255), (255, 255, 255),
     (255, 255, 255), (255, 255, 255), (255, 255, 255)],
]


def spawnFlake():
    spawn = random.randint(0, 1)
    if (spawn == 1):
        y = 0
        x = random.randint(0, 6)
        flakes.append([y, x])


def animateFlakes():
    for i, [y, x] in enumerate(flakes):
        r, g, b = pixels[y][x]
        picounicorn.set_pixel(y, x, r, g, b)
        if (y < 15):
            flakes[i] = [y + 1, x]
            picounicorn.set_pixel(flakes[i][0], flakes[i][1], 255, 255, 255)
            continue
        flakes.pop(i)


while True:
    t = time.ticks_ms() / 3600
    for x in range(w):
        for y in range(h):
            r, g, b = pixels[x][y]
            picounicorn.set_pixel(x, y, r, g, b)
    spawnFlake()
    animateFlakes()
    time.sleep(.8)
